 function checkCity(a) {
    var b;
    return $.ajax({
        type: "POST",
        async: !1,
        url: ctx + "/jobs/checkCity.json",
        data: {
            city: a
        }
    }).done(function(a) {
        b = a.success
    }),
    b
}
function img_check(a, b, c, d) {
	var e = $("#" + d).val();
	this.AllowExt = ".jpg,.gif,.jpeg,.png,.pjpeg", this.FileExt = a.value.substr(a.value.lastIndexOf(".")).toLowerCase(), 0 != this.AllowExt && -1 == this.AllowExt.indexOf(this.FileExt) ? $("#" + c + "_error").text("只支持jpg、gif、png、jpeg格式，请重新上传").show() : ($("#" + c + "_error").text("").hide(), $.ajaxFileUpload({
		url: b,
		secureuri: !1,
		fileElementId: c,
		data: {
			type: e
		},
		dataType: "text",
		success: function(a) {
			"" != a ? ($("#logoShow img").attr("src", ctx + "/" + a), $("#logoNo").hide(), $("#logoShow").show(), $("#logo").val(a)) : $("#" + c + "_error").text("上传失败，请重新上传").show()
		},
		error: function() {
			$("#" + c + "_error").text("上传失败，请重新上传").show()
		}
	}))
}
$(function() {
	var b, c, a = !1;
	window.onbeforeunload = function() {
		return a ? void 0 : "内容还未保存，确认离开该页面吗？ "
	},
	$("#stepTip a").bind("click", function() {
		$(this).parent("#stepTip").remove()
	}), 
	b = {expires: 1}, 
	null == $.cookie("viewTimes") ? ($("#stepTip img").attr("src", ctx + "/style/images/tiponce.jpg").parent("#stepTip").fadeIn(200), $.cookie("viewTimes", "1", b)) : (c = parseInt($.cookie("viewTimes")) + 1, $("#stepTip img").attr("src", ctx + "/style/images/tiponce.jpg").parent("#stepTip").fadeIn(200), $.cookie("viewTimes", c, b)), $(document).click(function() {
		var a = [];
		$("#box_industry li.current").length > 2 ? alert("行业领域最多可选2个") : ($("#box_industry li.current").each(function() {
			a.push($(this).text())
		}), "" == a.join() ? $("#select_industry").val("请选择行业领域") : $("#select_industry").val(a.join()), $("#select_industry_hidden").val(a.join()), $("#box_industry").hide()), $("#box_industry").hide(), $("#box_scale").hide(), $("#stagesList .box_invest").hide()
	}),
	$("#select_scale").bind("click", function(a) {
		a.stopPropagation(), $("#box_scale").show(), $("#box_industry").hide(), $("#stagesList .box_invest").hide()
	}), $("#box_scale").on("click", "ul li", function(a) {
		a.stopPropagation();
		var b = $(this).text();
		$("#select_scale,#select_scale_hidden").val(b), $("#box_scale").hide(), $("#stepForm").validate().element("#select_scale_hidden")
	}), $("#box_industry,#box_scale").bind("click", function(a) {
		a.stopPropagation()
	}),
	 $("#select_city").bind("click", function(a) {
			a.stopPropagation(), $("#box_city").show()
		}), $("#box_city").on("click", "ul li", function(a) {
			a.stopPropagation();
			var b = $(this).text();
			$("#select_city,#select_city_hidden").val(b), $("#box_city").hide()
		}), $("#box_city").bind("click", function(a) {
			a.stopPropagation()
		}),
	$(".s_radio li").click(function() {
		var b = $(this).text();
		$("#s_radio_hidden").val(b), $(this).addClass("current").append("<em></em>").siblings().removeClass("current").find("em").remove(), $("#stepForm").validate().element("#s_radio_hidden")
	}), $("#stagesList").on("click", ".select_invest", function(a) {
		a.stopPropagation(), $("#box_scale").hide(), $("#box_industry").hide(), $(this).parents("li").siblings().children(".box_invest").hide(), $(this).siblings(".box_invest").show()
	}), $("#stagesList").on("click", ".box_invest li", function(a) {
		var b, c;
		a.stopPropagation(), b = $(this).html(), c = $(this).parents("li"), $(".select_invest,.select_invest_hidden", c).val(b), $(this).parents(".box_invest").hide(), c.index() == $("#stagesList > li").length - 1 && $("#stagesList > li").length < 10 && c.children(".select_invest").trigger("change")
	}), $("#stagesList").on("change", ".select_invest", function() {
		var a = $("#cloneInvest").html();
		$("#stagesList").append("<li>" + a + "</li>")
	}), $("#stepForm").validate({
		onkeyup: !1,
		focusCleanup: !0,
		rules: {
			name: {
				required: !0,
				specialchar: !0,
				maxlenStr: 100
			},
			myfiles: {
				required: !1
			},
			website: {
				required: !0,
				checkUrl: !0,
				maxlength: 120
			},
			select_city_hidden: {
				required: !0,
				cityAvailable: !0,
				maxlenStr: 20
			},
			select_scale_hidden: {
				required: !0
			},
			s_radio_hidden: {
				required: !0
			} 
		},
		messages: {
			name: {
				required: "请输入有效的公司简称",
				specialchar: "请输入有效的公司简称",
				maxlenStr: "请输入100字以内的公司简称"
			},
			website: {
				required: "请输入公司网址，如：www.lagou.com",
				checkUrl: "请输入有效的公司网址",
				maxlength: "请输入120字符以内的网址"
			},
			select_city_hidden: {
				required: "请输入公司所在城市，如：北京",
				maxlenStr: "请输入有效的公司所在城市"
			},
			select_scale_hidden: {
				required: "请选择公司规模"
			},
			s_radio_hidden: {
				required: "请选择公司发展阶段"
			}
		},
		errorPlacement: function(a, b) {
			"hidden" == b.attr("type") ? a.insertAfter($(b).parent()) : a.insertAfter(b)
		},
		submitHandler: function(b) {
			var c, d, e, f, g, h, i, j, k, l, m, n, o;
			a = !0, c = $("#eid").val(), d = $("#cname").val(), e = $("#name").val(), f = $("#logoShow img").attr("src"), g = $("#website").val(), "http://" != g.substring(0, 7) && (g = "http://" + g), h = $("#city").val(),  j = $("#select_scale_hidden").val(), k = $("#s_radio_hidden").val(), $(b).find(":submit").attr("disabled", !0), $.ajax({
				type: "POST",
				data: {
					eid: c,
					cname: d,
					csname: e,
					clogo: f,
					curl: g,
					city: h,
					cscale: j,
					cfunder: k
				},
				url: ctx + "/Ccenter/Index/indexFirstCreate.html"
			}).done(function(a) {
				a.success ? window.location.href = ctx + "/Ccenter/Index/indexSec.html" : $("#beError").text(a.msg).show(), $(b).find(":submit").attr("disabled", !1)
			})
		}
	}),
	
	 jQuery.validator.addMethod("cityAvailable",
    function(a, b) {
        return a;
    },
    "请输入有效的公司所在城市，如：北京")
});